!!! 5
%html
  %head
    %title= title
    = render 'layouts/stylesheets'
    = javascript_include_tag "application"
    = javascript_include_tag "jquery-ui-1.8.18.custom.min"
    = csrf_meta_tag
  %body
    %div
      = render 'layouts/header'
      %div{ :id => "container" }
        - flash.each do |key, value| 
          %div{ :class => "alert alert-#{key}" }
            = value
        %div{ :id => "content" }
          = yield
      = render 'layouts/footer'
      = debug(params) if Rails.env.development?
    %div{ :id => "dialogs" }
    :javascript
      jQuery(function($) {
        $("#help_nav")
          .bind("ajax:success", function(evt, data, status, xhr) {
            $("#content").html(xhr.responseText);
          })
          .bind("ajax:error", function() {
            alert("Help ajax failed");
          });
     
        $("#signin_nav")
          .bind("ajax:success", function(evt, data, status, xhr) {
            $("#dialogs").append(xhr.responseText);
          })
          .bind("ajax:error", function() {
            alert("Signin ajax failed: ");
          });
      });
      $(function() {
        $("#signin_nav")
          .click(function(event) {
            if(document.getElementById("signin-dialog")) {
              $("#signin-dialog").dialog( "open" );
            } else {
              $.get('#{signin_path}', undefined,
                function(data, status, xhr) {
                  $("#dialogs").append(xhr.responseText);
                });
            }
        });
      });